{"version":3,"sources":["Canvas.js","FileUpload.js","Box.js","App.js","reportWebVitals.js","index.js"],"names":["Canvas","file","img","position","setImgLoaded","useState","top","setTop","left","setLeft","width","setWidth","height","setHeight","useEffect","current","src","tf","process","then","model","tensor","fromPixels","sliced","length","readyfied","resizeNearestNeighbor","div","reshape","predict","array","rect","getBoundingClientRect","faceBoxTop","faceBoxLeft","faceBoxHeight","faceBoxWidth","className","ref","alt","style","FileUpload","setFile","type","name","onChange","e","target","files","substr","reader","FileReader","onload","result","readAsDataURL","Box","box","setPosition","imgLoaded","setLength","dragging","useRef","x","y","imgWidth","imgHeight","imgTop","imgLeft","imgBottom","imgRight","byWidth","bottom","right","isWithinLimitsWidth","newTop","newBottom","isWithinLimitsHeight","newLeft","newRight","onMouseDown","window","event","preventDefault","clientX","clientY","onMouseMove","posX","posY","onMouseUp","Math","floor","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b1798a37.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport * as tf from \"@tensorflow/tfjs\";\r\n\r\nconst MODEL_PATH = process.env.PUBLIC_URL + \"/model/model.json\";\r\n\r\nexport default function Canvas({ file, img, position, setImgLoaded }) {\r\n  const [top, setTop] = useState(null);\r\n  const [left, setLeft] = useState(null);\r\n  const [width, setWidth] = useState(null);\r\n  const [height, setHeight] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (!file) return;\r\n    img.current.src = file;\r\n    setImgLoaded(file);\r\n    if (!position) return;\r\n    tf.tidy(() => {\r\n      tf.loadLayersModel(MODEL_PATH).then((model) => {\r\n        const tensor = tf.browser.fromPixels(img.current);\r\n        const sliced = tf.slice(\r\n          tensor,\r\n          [position.top, position.left],\r\n          [position.length, position.length]\r\n        );\r\n        const readyfied = tf.image\r\n          .resizeNearestNeighbor(sliced, [256, 256], true)\r\n          .div(255)\r\n          .reshape([1, 256, 256, 3]);\r\n        const result = model.predict(readyfied);\r\n        result.array().then((array) => {\r\n          array = array[0];\r\n          const rect = img.current.getBoundingClientRect();\r\n          const faceBoxTop =\r\n            rect.top + position.top + array[0] * position.length;\r\n          const faceBoxLeft =\r\n            rect.left + position.left + array[1] * position.length;\r\n          const faceBoxHeight = (array[2] - array[0]) * position.length;\r\n          const faceBoxWidth = (array[3] - array[1]) * position.length;\r\n          setTop(faceBoxTop);\r\n          setLeft(faceBoxLeft);\r\n          setHeight(faceBoxHeight);\r\n          setWidth(faceBoxWidth);\r\n        });\r\n      });\r\n    });\r\n  }, [file, position]);\r\n\r\n  if (!file) return null;\r\n\r\n  return (\r\n    <>\r\n      <img className=\"img\" ref={img} src=\"\" alt=\"pet\" />\r\n      <div\r\n        className=\"faceBox\"\r\n        style={{ top: top, left: left, width: width, height: height}}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nexport default function FileUpload({ setFile }) {\r\n  const readFile = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file && file.type.substr(0, 5) === \"image\") {\r\n      const reader = new FileReader();\r\n      reader.onload = function (e) {\r\n        setFile(reader.result);\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <input className=\"inputFile\" type=\"file\" name=\"file\" onChange={readFile} />\r\n  );\r\n}\r\n","import React, { useEffect, useState, useRef } from \"react\";\r\n\r\nexport default function Box({ img, box, position, setPosition, imgLoaded }) {\r\n  const [top, setTop] = useState();\r\n  const [left, setLeft] = useState();\r\n  const [length, setLength] = useState();\r\n  const dragging = useRef(false);\r\n  const x = useRef();\r\n  const y = useRef();\r\n  const imgWidth = useRef();\r\n  const imgHeight = useRef();\r\n  const imgTop = useRef();\r\n  const imgLeft = useRef();\r\n  const imgBottom = useRef();\r\n  const imgRight = useRef();\r\n  const byWidth = useRef();\r\n\r\n  useEffect(() => {\r\n    if (!img.current) return;\r\n    const rect = img.current.getBoundingClientRect();\r\n    imgTop.current = rect.top;\r\n    imgLeft.current = rect.left;\r\n    imgBottom.current = rect.bottom;\r\n    imgRight.current = rect.right;\r\n    imgWidth.current = img.current.width;\r\n    imgHeight.current = img.current.height;\r\n    if (imgWidth.current > imgHeight.current) {\r\n      setLength(imgHeight.current);\r\n      byWidth.current = false;\r\n    } else {\r\n      setLength(imgWidth.current);\r\n      byWidth.current = true;\r\n    }\r\n    setTop(imgTop.current);\r\n    setLeft(imgLeft.current);\r\n  }, [imgLoaded]);\r\n\r\n  const onMouseDown = (e) => {\r\n    e = e || window.event;\r\n    e.preventDefault();\r\n    dragging.current = true;\r\n    x.current = e.clientX;\r\n    y.current = e.clientY;\r\n  };\r\n\r\n  const onMouseMove = (e) => {\r\n    if (dragging.current) {\r\n      e = e || window.event;\r\n      e.preventDefault();\r\n      const posX = x.current - e.clientX;\r\n      const posY = y.current - e.clientY;\r\n      x.current = e.clientX;\r\n      y.current = e.clientY;\r\n      if (byWidth.current) {\r\n        const newTop = top - posY;\r\n        if (isWithinLimitsWidth(newTop)) {\r\n          setTop(newTop);\r\n        }\r\n      } else {\r\n        const newLeft = left - posX;\r\n        if (isWithinLimitsHeight(newLeft)) {\r\n          setLeft(newLeft);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const isWithinLimitsWidth = (newTop) => {\r\n    const newBottom = newTop + length;\r\n    if (newTop < imgTop.current || newBottom > imgBottom.current) {\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  };\r\n\r\n  const isWithinLimitsHeight = (newLeft) => {\r\n    const newRight = newLeft + length;\r\n    if (newLeft < imgLeft.current || newRight > imgRight.current) {\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  };\r\n\r\n  const onMouseUp = (e) => {\r\n    dragging.current = false;\r\n    setPosition({\r\n      top: Math.floor(top - imgTop.current),\r\n      left: Math.floor(left - imgLeft.current),\r\n      length: Math.floor(length),\r\n    });\r\n  };\r\n\r\n  if (!img.current) return null;\r\n  return (\r\n    <div\r\n      ref={box}\r\n      className=\"box\"\r\n      onMouseDown={onMouseDown}\r\n      onMouseMove={onMouseMove}\r\n      onMouseUp={onMouseUp}\r\n      style={{ width: length, height: length, top: top, left: left }}\r\n    />\r\n  );\r\n}\r\n","import \"./App.css\";\nimport React, { useState, useRef } from \"react\";\nimport Canvas from \"./Canvas\";\nimport FileUpload from \"./FileUpload\";\nimport Box from \"./Box\";\n\nexport default function App() {\n  const [file, setFile] = useState(null);\n  const [position, setPosition] = useState(null);\n  const [imgLoaded, setImgLoaded] = useState(null);\n  const box = useRef(null);\n  const img = useRef(null);\n\n  return (\n    <>\n      <FileUpload setFile={setFile} />\n      <Box\n        img={img}\n        box={box}\n        position={position}\n        setPosition={setPosition}\n        imgLoaded={imgLoaded}\n      />\n      <Canvas\n        file={file}\n        img={img}\n        position={position}\n        setImgLoaded={setImgLoaded}\n      />\n    </>\n  );\n}\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}